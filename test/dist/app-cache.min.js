!function(){function t(){this._manifest=this.getManifest(),this._response=[],this._manifest||(this.initManifest(),this._manifest=this.getManifest())}var e={success:function(){}};t.VERSION="0.0.3",t.PREFIX="__app_cache__",t.NOOP=function(){},t._instance=null,t.load=function(e,n){return t._instance||(t._instance=new t),t._instance.load(e,n),t._instance},t.diff=function(t,e){return t.filter(function(t){return-1===e.indexOf(t)})},t.prototype={constructor:t,loadQueue:function(e){var n=this,s=this._loadOptions.success||t.NOOP,i=this._loadOptions.error||t.NOOP,o=this._loadFiles[e],a=this._loadFiles.length;n.loadText(o,{success:function(t){var i=t.content,c=t.type,r=c.indexOf("javascript")>-1?"injectScript":"injectStyle";n._response.push(t),n[r](i),n._manifest.files[o]=!0,n.setManifest(n._manifest),n.setStore(o,i),n._response.length===a?s(n._response):n.loadQueue(e+1)},error:i})},load:function(t,n){this._loadFiles=t,this._loadOptions=n||e,this.syncManifest(t),this.loadQueue(0)}},window.AppCache=t}(),function(t){t.prototype.loadFromXHR=function(t,e,n,s){var i=new XMLHttpRequest;i.open("GET",t),i.onreadystatechange=function(){4===i.readyState&&(200===i.status||0===i.status&&i.responseText?e({content:i.responseText,type:i.getResponseHeader("content-type")}):n(i.statusText))},setTimeout(function(){i.readyState<4&&(i.abort(),n(i.statusText))},s),i.send()}}(AppCache),function(t){t.prototype.loadFromCache=function(t,e,n,s){try{var i=t.indexOf("?"),o=-1===i?t:t.slice(0,i);e({content:this.getStore(t),type:"js"===o.slice(-2)?"application/javascript":"text/css"})}catch(t){n(t)}}}(AppCache),function(t){t.prototype.hasLoad=function(t){return this.getManifest().files[t]},t.prototype.loadText=function(e,n){var s=n.timeout||3e4,i=n.success||t.NOOP,o=n.error||t.NOOP;this.hasLoad(e)?this.loadFromCache(e,i,o,s):this.loadFromXHR(e,i,o,s)}}(AppCache),function(t){var e=document.head||document.getElementsByTagName("head")[0];t.injectScript=t.prototype.injectScript=function(t){var n=document.createElement("script");n.defer=!0,n.text=t,e.appendChild(n)}}(AppCache),function(t){var e=document.head||document.getElementsByTagName("head")[0];t.injectStyle=t.prototype.injectStyle=function(t){var n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t)),e.appendChild(n)}}(AppCache),function(t){var e=t.prototype,n=window.localStorage,s=function(t){return"string"==typeof t};e.setStore=function(e,i){var o=t.PREFIX,a=o+e,c=s(i)?i:JSON.stringify(i);n.setItem(a,c)},e.getStore=function(e,s){var i=t.PREFIX,o=i+e,a=n.getItem(o);return"json"===s?JSON.parse(a):a},e.removeStore=function(e){var s=t.PREFIX,i=s+e;n.removeItem(i)},e.clearStore=function(){var e=Object.keys(n),s=t.PREFIX;e.forEach(function(t){0===t.indexOf(s)&&n.removeItem(t)})}}(AppCache),function(t){var e=t.prototype;e.initManifest=function(){this.setStore("manifest",{prefix:t.PREFIX,files:{}})},e.syncManifest=function(e){var n,s,i,o=this._manifest.files,a=Object.keys(o),c=t.diff(e,a),r=t.diff(a,e);for(n=0,s=c.length;n<s;n++)i=c[n],o[i]=!1;for(n=0,s=r.length;n<s;n++)i=r[n],delete o[i],this.removeStore(i);this._manifest.files=o},e.hasManifest=function(){return!!this.getStore("manifest")},e.getManifest=function(){return this.getStore("manifest","json")},e.setManifest=function(t){this.setStore("manifest",t)}}(AppCache);